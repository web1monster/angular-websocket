{"version":3,"sources":["src/angular-websocket.js"],"names":["$WebSocketProvider","$rootScope","$q","$timeout","$websocketBackend","safeDigest","autoApply","$$phase","$apply","$WebSocket","url","options","protocols","isString","isArray","this","ssl","test","_reconnectAttempts","initialTimeout","maxTimeout","sendQueue","onOpenCallbacks","onMessageCallbacks","onErrorCallbacks","onCloseCallbacks","objectFreeze","_readyStateConstants","_connect","_setInternalState","prototype","CONNECTING","OPEN","CLOSING","CLOSED","RECONNECT_ABORTED","_reconnectableStatusCodes","close","force","socket","bufferedAmount","readyState","createWebSocketBackend","protocol","onopen","_onOpenHandler","bind","onmessage","_onMessageHandler","onerror","_onErrorHandler","onclose","_onCloseHandler","fireQueue","length","data","shift","send","message","JSON","stringify","deferred","resolve","notifyOpenCallbacks","i","call","notifyCloseCallbacks","event","notifyErrorCallbacks","onOpen","cb","push","onClose","onError","onMessage","callback","isFunction","Error","isDefined","filter","RegExp","fn","pattern","undefined","indexOf","code","reconnect","currentCallback","exec","cancelableify","promise","cancel","then","newPromise","apply","arguments","reason","splice","reject","defer","angular","_getBackoffDelay","attempt","R","Math","random","T","F","N","M","floor","min","pow","state","objectDefineProperty","_internalConnectionState","forEach","pending","get","set","$WebSocketBackend","$window","Socket","ws","match","exports","require","Client","client","e","WebSocket","MozWebSocket","noop","Object","freeze","defineProperty","Array","elt","len","from","Number","ceil","$inject","module","factory","service"],"mappings":"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"}