{"version":3,"sources":["src/angular-websocket.js"],"names":["$WebSocketProvider","$rootScope","$q","$timeout","$websocketBackend","$WebSocket","url","protocols","options","isObject","isArray","undefined","this","ssl","test","scope","rootScopeFailover","useApplyAsync","_reconnectAttempts","reconnectAttempts","initialTimeout","maxTimeout","reconnectIfNotNormalClose","sendQueue","onOpenCallbacks","onMessageCallbacks","onErrorCallbacks","onCloseCallbacks","objectFreeze","_readyStateConstants","_connect","_setInternalState","prototype","CONNECTING","OPEN","CLOSING","CLOSED","RECONNECT_ABORTED","_normalCloseCode","_reconnectableStatusCodes","safeDigest","autoApply","$$phase","$digest","bindToScope","self","$on","force","socket","readyState","create","onmessage","angular","bind","_onMessageHandler","onopen","_onOpenHandler","onerror","_onErrorHandler","onclose","_onCloseHandler","fireQueue","length","data","shift","send","isString","message","JSON","stringify","deferred","resolve","notifyOpenCallbacks","event","i","call","notifyCloseCallbacks","notifyErrorCallbacks","onOpen","cb","push","onClose","onError","onMessage","callback","isFunction","Error","isDefined","filter","RegExp","fn","pattern","code","indexOf","reconnect","applyAsyncOrDigest","args","arraySlice","arguments","$applyAsync","apply","currentCallback","exec","close","bufferedAmount","cancelableify","promise","cancel","then","newPromise","reason","splice","reject","defer","_getBackoffDelay","attempt","R","Math","random","T","F","N","M","floor","min","pow","state","objectDefineProperty","_internalConnectionState","forEach","pending","get","set","$WebSocketBackendProvider","$window","$log","Socket","ws","match","exports","require","Client","client","e","WebSocket","MozWebSocket","createWebSocketBackend","warn","noop","Object","freeze","defineProperty","Array","slice","elt","len","from","Number","ceil","module","factory","service","define"],"mappings":"CAAC,WACC,YA8BA,SAASA,GAAmBC,EAAYC,EAAIC,EAAUC,GAEpD,QAASC,GAAWC,EAAKC,EAAWC,GAC7BA,IAAWC,EAASF,IAAeG,EAAQH,KAC9CC,EAAUD,EACVA,EAAYI,QAGdC,KAAKL,UAAYA,EACjBK,KAAKN,IAAMA,GAAO,cAClBM,KAAKC,IAAM,SAASC,KAAKF,KAAKN,KAS9BM,KAAKG,MAA8BP,GAAWA,EAAQO,OAA8Bd,EACpFW,KAAKI,kBAA8BR,GAAWA,EAAQQ,oBAA8B,EACpFJ,KAAKK,cAA8BT,GAAWA,EAAQS,gBAA8B,EACpFL,KAAKM,mBAA8BV,GAAWA,EAAQW,mBAA8B,EACpFP,KAAKQ,eAA8BZ,GAAWA,EAAQY,gBAA8B,IACpFR,KAAKS,WAA8Bb,GAAWA,EAAQa,YAA8B,IACpFT,KAAKU,0BAA8Bd,GAAWA,EAAQc,4BAA8B,EAEpFV,KAAKW,aACLX,KAAKY,mBACLZ,KAAKa,sBACLb,KAAKc,oBACLd,KAAKe,oBAELC,EAAahB,KAAKiB,sBAEdvB,EACFM,KAAKkB,WAELlB,KAAKmB,kBAAkB,GA6P3B,MAvPA1B,GAAW2B,UAAUH,sBACnBI,WAAc,EACdC,KAAQ,EACRC,QAAW,EACXC,OAAU,EACVC,kBAAqB,GAGvBhC,EAAW2B,UAAUM,iBAAmB,IAExCjC,EAAW2B,UAAUO,2BACnB,KAGFlC,EAAW2B,UAAUQ,WAAa,SAAoBC,GAChDA,IAAc7B,KAAKG,MAAM2B,SAC3B9B,KAAKG,MAAM4B,WAIftC,EAAW2B,UAAUY,YAAc,SAAqB7B,GACtD,GAAI8B,GAAOjC,IASX,OARIG,KACFH,KAAKG,MAAQA,EACTH,KAAKI,mBACPJ,KAAKG,MAAM+B,IAAI,WAAY,WACzBD,EAAK9B,MAAQd,KAIZ4C,GAGTxC,EAAW2B,UAAUF,SAAW,SAAkBiB,IAC5CA,IAAUnC,KAAKoC,QAAUpC,KAAKoC,OAAOC,aAAerC,KAAKiB,qBAAqBK,QAChFtB,KAAKoC,OAAS5C,EAAkB8C,OAAOtC,KAAKN,IAAKM,KAAKL,WACtDK,KAAKoC,OAAOG,UAAYC,QAAQC,KAAKzC,KAAMA,KAAK0C,mBAChD1C,KAAKoC,OAAOO,OAAUH,QAAQC,KAAKzC,KAAMA,KAAK4C,gBAC9C5C,KAAKoC,OAAOS,QAAUL,QAAQC,KAAKzC,KAAMA,KAAK8C,iBAC9C9C,KAAKoC,OAAOW,QAAUP,QAAQC,KAAKzC,KAAMA,KAAKgD,mBAIlDvD,EAAW2B,UAAU6B,UAAY,WAC/B,KAAOjD,KAAKW,UAAUuC,QAAUlD,KAAKoC,OAAOC,aAAerC,KAAKiB,qBAAqBK,MAAM,CACzF,GAAI6B,GAAOnD,KAAKW,UAAUyC,OAE1BpD,MAAKoC,OAAOiB,KACVC,EAASH,EAAKI,SAAWJ,EAAKI,QAAUC,KAAKC,UAAUN,EAAKI,UAE9DJ,EAAKO,SAASC,YAIlBlE,EAAW2B,UAAUwC,oBAAsB,SAA6BC,GACtE,IAAK,GAAIC,GAAI,EAAGA,EAAI9D,KAAKY,gBAAgBsC,OAAQY,IAC/C9D,KAAKY,gBAAgBkD,GAAGC,KAAK/D,KAAM6D,IAIvCpE,EAAW2B,UAAU4C,qBAAuB,SAA8BH,GACxE,IAAK,GAAIC,GAAI,EAAGA,EAAI9D,KAAKe,iBAAiBmC,OAAQY,IAChD9D,KAAKe,iBAAiB+C,GAAGC,KAAK/D,KAAM6D,IAIxCpE,EAAW2B,UAAU6C,qBAAuB,SAA8BJ,GACxE,IAAK,GAAIC,GAAI,EAAGA,EAAI9D,KAAKc,iBAAiBoC,OAAQY,IAChD9D,KAAKc,iBAAiBgD,GAAGC,KAAK/D,KAAM6D,IAIxCpE,EAAW2B,UAAU8C,OAAS,SAAgBC,GAE5C,MADAnE,MAAKY,gBAAgBwD,KAAKD,GACnBnE,MAGTP,EAAW2B,UAAUiD,QAAU,SAAiBF,GAE9C,MADAnE,MAAKe,iBAAiBqD,KAAKD,GACpBnE,MAGTP,EAAW2B,UAAUkD,QAAU,SAAiBH,GAE9C,MADAnE,MAAKc,iBAAiBsD,KAAKD,GACpBnE,MAITP,EAAW2B,UAAUmD,UAAY,SAAmBC,EAAU5E,GAC5D,IAAK6E,EAAWD,GACd,KAAM,IAAIE,OAAM,8BAGlB,IAAI9E,GAAW+E,EAAU/E,EAAQgF,UAAYtB,EAAS1D,EAAQgF,WAAahF,EAAQgF,iBAAkBC,SACnG,KAAM,IAAIH,OAAM,iDAQlB,OALA1E,MAAKa,mBAAmBuD,MACtBU,GAAIN,EACJO,QAASnF,EAAUA,EAAQgF,OAAS7E,OACpC8B,UAAWjC,EAAUA,EAAQiC,WAAY,IAEpC7B,MAGTP,EAAW2B,UAAUwB,eAAiB,SAAwBiB,GAC5D7D,KAAKM,mBAAqB,EAC1BN,KAAK4D,oBAAoBC,GACzB7D,KAAKiD,aAGPxD,EAAW2B,UAAU4B,gBAAkB,SAAyBa,GAC9D7D,KAAKgE,qBAAqBH,IACrB7D,KAAKU,2BAA6BmD,EAAMmB,OAAShF,KAAK0B,kBAAqB1B,KAAK2B,0BAA0BsD,QAAQpB,EAAMmB,MAAQ,KACnIhF,KAAKkF,aAITzF,EAAW2B,UAAU0B,gBAAkB,SAAyBe,GAC9D7D,KAAKiE,qBAAqBJ,IAG5BpE,EAAW2B,UAAUsB,kBAAoB,SAA2Ba,GAoBlE,QAAS4B,GAAmBX,EAAU3C,EAAWuD,GAC/CA,EAAOC,EAAWtB,KAAKuB,UAAW,GAC9BrD,EAAK5B,cACP4B,EAAK9B,MAAMoF,YAAY,WACrBf,EAASgB,MAAMvD,EAAMmD,MAGvBZ,EAASgB,MAAMvD,EAAMmD,GACrBnD,EAAKL,WAAWC,IAxBpB,IAAK,GAHDkD,GAEAU,EADAxD,EAAOjC,KAEF8D,EAAI,EAAGA,EAAI7B,EAAKpB,mBAAmBqC,OAAQY,IAClD2B,EAAkBxD,EAAKpB,mBAAmBiD,GAC1CiB,EAAUU,EAAgBV,QACtBA,EACEzB,EAASyB,IAAYxB,EAAQJ,OAAS4B,EACxCI,EAAmBM,EAAgBX,GAAIW,EAAgB5D,UAAW0B,GAE3DwB,YAAmBF,SAAUE,EAAQW,KAAKnC,EAAQJ,OACzDgC,EAAmBM,EAAgBX,GAAIW,EAAgB5D,UAAW0B,GAIpE4B,EAAmBM,EAAgBX,GAAIW,EAAgB5D,UAAW0B,IAkBxE9D,EAAW2B,UAAUuE,MAAQ,SAAexD,GAI1C,OAHIA,IAAUnC,KAAKoC,OAAOwD,iBACxB5F,KAAKoC,OAAOuD,QAEP3F,MAGTP,EAAW2B,UAAUiC,KAAO,SAAcF,GAiBxC,QAAS0C,GAAcC,GACrBA,EAAQC,OAASA,CACjB,IAAIC,GAAOF,EAAQE,IAKnB,OAJAF,GAAQE,KAAO,WACb,GAAIC,GAAaD,EAAKR,MAAMxF,KAAMsF,UAClC,OAAOO,GAAcI,IAEhBH,EAGT,QAASC,GAAOG,GAGd,MAFAjE,GAAKtB,UAAUwF,OAAOlE,EAAKtB,UAAUsE,QAAQ9B,GAAO,GACpDO,EAAS0C,OAAOF,GACTjE,EA7BT,GAAIyB,GAAWpE,EAAG+G,QACdpE,EAAOjC,KACP8F,EAAUD,EAAcnC,EAASoC,QA8BrC,OA5BI7D,GAAKI,aAAeJ,EAAKhB,qBAAqBQ,kBAChDiC,EAAS0C,OAAO,sCAGhBnE,EAAKtB,UAAUyD,MACbb,QAASJ,EACTO,SAAUA,IAEZzB,EAAKgB,aAoBA6C,GAGTrG,EAAW2B,UAAU8D,UAAY,WAK/B,MAJAlF,MAAK2F,QAELpG,EAASiD,QAAQC,KAAKzC,KAAMA,KAAKkB,UAAWlB,KAAKsG,mBAAmBtG,KAAKM,qBAElEN,MAITP,EAAW2B,UAAUkF,iBAAmB,SAA0BC,GAChE,GAAIC,GAAIC,KAAKC,SAAW,EACpBC,EAAI3G,KAAKQ,eACToG,EAAI,EACJC,EAAIN,EACJO,EAAI9G,KAAKS,UAEb,OAAOgG,MAAKM,MAAMN,KAAKO,IAAIR,EAAIG,EAAIF,KAAKQ,IAAIL,EAAGC,GAAIC,KAGrDrH,EAAW2B,UAAUD,kBAAoB,SAA2B+F,GAClE,GAAIT,KAAKM,MAAMG,KAAWA,GAAiB,EAARA,GAAaA,EAAQ,EACtD,KAAM,IAAIxC,OAAM,kDAAoDwC,EAIjEC,KACHnH,KAAKqC,WAAa6E,GAASlH,KAAKoC,OAAOC,YAEzCrC,KAAKoH,yBAA2BF,EAGhCG,EAAQrH,KAAKW,UAAW,SAAS2G,GAC/BA,EAAQ5D,SAAS0C,OAAO,wDAKxBe,GACFA,EAAqB1H,EAAW2B,UAAW,cACzCmG,IAAK,WACH,MAAOvH,MAAKoH,0BAA4BpH,KAAKoC,OAAOC,YAEtDmF,IAAK,WACH,KAAM,IAAI9C,OAAM,2CAKf,SAAShF,EAAKC,GACnB,MAAO,IAAIF,GAAWC,EAAKC,IAK/B,QAAS8H,GAA0BC,EAASC,GAC1C3H,KAAKsC,OAAS,SAAgB5C,EAAKC,GACjC,GACIiI,GAAQC,EADRC,EAAQ,YAAYpC,KAAKhG,EAE7B,KAAKoI,EACH,KAAM,IAAIpD,OAAM,uBAIlB,IAAuB,gBAAZqD,UAAwBC,QACjC,IACEH,EAAKG,QAAQ,MACbJ,EAAUC,EAAGI,QAAUJ,EAAGK,QAAUL,EACpC,MAAMM,IAMV,MAFAP,GAASA,GAAUF,EAAQU,WAAaV,EAAQW,aAE5C1I,EACK,GAAIiI,GAAOlI,EAAKC,GAGlB,GAAIiI,GAAOlI,IAEpBM,KAAKsI,uBAAyB,SAAgC5I,EAAKC,GAEjE,MADAgI,GAAKY,KAAK,kDACHvI,KAAKsC,OAAO5C,EAAKC,IAhW5B,GAAI6I,GAAOhG,QAAQgG,KACfxH,EAAiByH,OAAa,OAAIA,OAAOC,OAASF,EAClDrB,EAAuBsB,OAAOE,eAC9BrF,EAAad,QAAQc,SACrBmB,EAAajC,QAAQiC,WACrBE,EAAanC,QAAQmC,UACrB9E,EAAa2C,QAAQ3C,SACrBC,EAAa0C,QAAQ1C,QACrBuH,EAAa7E,QAAQ6E,QACrBhC,EAAauD,MAAMxH,UAAUyH,KAE5BD,OAAMxH,UAAU6D,UACnB2D,MAAMxH,UAAU6D,QAAU,SAAS6D,GACjC,GAAIC,GAAM/I,KAAKkD,SAAW,EACtB8F,EAAOC,OAAO3D,UAAU,KAAO,CAMnC,KALA0D,EAAe,EAAPA,EAAYvC,KAAKyC,KAAKF,GAAQvC,KAAKM,MAAMiC,GACtC,EAAPA,IACFA,GAAQD,GAGIA,EAAPC,EAAYA,IACjB,GAAIA,IAAQhJ,OAAQA,KAAKgJ,KAAUF,EAAO,MAAOE,EAEnD,OAAO,KA6UXxG,QAAQ2G,OAAO,kBACdC,QAAQ,cAAe,aAAc,KAAM,WAAY,oBAAqBhK,IAC5EgK,QAAQ,aAAe,aAAc,KAAM,WAAY,mBAAqBhK,IAC5EiK,QAAQ,qBAAsB,UAAW,OAAQ5B,IACjD4B,QAAQ,oBAAsB,UAAW,OAAQ5B,IAGlDjF,QAAQ2G,OAAO,qBAAsB,gBAEf,gBAAXA,SAAyC,kBAAXG,UACvCH,OAAOpB,QAAUvF,QAAQ2G,OAAO"}